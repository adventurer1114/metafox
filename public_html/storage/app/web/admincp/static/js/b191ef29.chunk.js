"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-admincp-blocks-AdminChartStats-Block"],{62425:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var l=a(85597),n=a(21241),r=a(67294),o=a(61560),i=a(26495),s=a(30120),u=a(17888),d=a(84917),c=a(74825),m=a(16681),p=a(81719),g=a(13218),h=a.n(g),f=a(30381),v=a.n(f);o.kL.register(o.uw,o.f$,o.od,o.jn,o.Dx,o.u,o.De);let E=(0,p.ZP)(n.sU,{slot:"BlockContent"})(({theme:e})=>({height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"})),b=(0,p.ZP)("div",{slot:"HeaderWrapper"})(({theme:e})=>({display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:e.spacing(3),[e.breakpoints.down("lg")]:{flexDirection:"column"}})),k=(0,p.ZP)("div",{slot:"HeaderLeftWrapper"})(({theme:e})=>({height:"auto",[e.breakpoints.down("lg")]:{marginBottom:e.spacing(2)}})),y=(0,p.ZP)("div",{slot:"HeaderRightWrapper"})(({theme:e})=>({height:"auto","& .MuiSelect-select":{paddingTop:e.spacing(1),paddingBottom:e.spacing(1)}})),Z=(0,p.ZP)("h3",{slot:"TitleHeader"})(({theme:e})=>({fontSize:e.spacing(2.5),margin:e.spacing(0),fontWeight:"normal"})),x=(0,p.ZP)("span",{slot:"Time"})(({theme:e})=>({color:e.palette.grey[700],height:e.spacing(2),display:"block"})),C=(0,p.ZP)("div",{slot:"Chart"})(({theme:e})=>({color:e.palette.grey[700],position:"relative","&.loading canvas":{opacity:.1}})),w=(0,p.ZP)(s.Z,{slot:"Loading"})(({theme:e})=>({height:"100%",width:"100%",justifyContent:"center",display:"flex",position:"absolute"}));var P=(0,l.j4Z)({extendBlock:function({blockProps:e,title:t}){var a,o;let{useFetchDetail:s,apiClient:p,jsxBackend:g,i18n:f}=(0,l.OgA)(),[P,S]=r.useState([]),[_,B]=r.useState(""),[W,j]=r.useState(""),[D,L]=r.useState("1d"),[T,H]=r.useState(!0),M=(0,l.kPO)(),[z]=s({dataSource:{apiUrl:"admincp/dashboard/stat-type"}}),A=r.useCallback((e,t)=>{H(!0),L(t),p.request({method:"get",url:`admincp/dashboard/chart?name=${e}&period=${t}`}).then(e=>{S(e.data.data),setTimeout(()=>{H(!1)},300)})},[p]),F=e=>{B(e.target.value),A(e.target.value,W)},O=e=>{j(e.target.value),A(_,e.target.value)};(0,r.useEffect)(()=>{h()(z)&&(B("user"),j("1d"),A("user","1d"))},[A,z]);let $=[],U=[];null==P||P.forEach(e=>{if(U.push(e.data),"1d"===D){$.push(v()(null==e?void 0:e.date).format("ll"));return}$.push(null==e?void 0:e.date)});let q={labels:$,datasets:[{data:U,borderColor:"#2682d5",backgroundColor:"#2682d5"}]},I=P.filter(e=>{return e.data>0}),N={responsive:!0,plugins:{legend:!1,title:{display:!1}}};return r.createElement(n.gO,null,r.createElement(E,null,r.createElement(b,null,r.createElement(k,null,r.createElement(Z,null,f.formatMessage({id:"welcome_back_username"},{username:M.user.full_name})),r.createElement(x,null,T?null:r.createElement(r.Fragment,null,$[0]," - ",$[$.length-1]," "))),r.createElement(y,null,r.createElement(u.Z,{sx:{m:1,minWidth:200},size:"small"},r.createElement(d.Z,null,f.formatMessage({id:"type"})),r.createElement(m.Z,{value:_,label:"Type",onChange:F},null==z?void 0:null===(a=z.types)||void 0===a?void 0:a.map((e,t)=>r.createElement(c.Z,{key:t,value:e.value},e.label)))),r.createElement(u.Z,{sx:{m:1,minWidth:200},size:"small"},r.createElement(d.Z,null,f.formatMessage({id:"view"})),r.createElement(m.Z,{value:W,label:"View",onChange:O},null==z?void 0:null===(o=z.period)||void 0===o?void 0:o.map((e,t)=>r.createElement(c.Z,{key:t,value:e.value},e.label)))))),r.createElement(C,{className:T?"loading":""},r.createElement(r.Fragment,null,T?r.createElement(w,null,g.render({component:"form.DefaultLoading"})):null,0!==I.length?r.createElement(r.Fragment,null," ",r.createElement(i.x1,{width:500,data:q,options:N})," "):r.createElement(i.x1,{width:500,data:q,options:{...N,scales:{y:{min:0}}}})))))},defaults:{title:"Chart",blockLayout:"Admin - Contained",blockProps:{blockStyle:{sx:{height:"calc(100% - 16px)"}}}}})}}]);