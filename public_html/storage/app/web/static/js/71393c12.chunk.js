"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-core-blocks-ListView-ListViewBlock"],{33187:function(e,t,l){l.r(t),l.d(t,{default:function(){return h}});var n=l(85597),r=l(21241),a=l(27274),o=l(30030),i=l(71682),s=l(1469),c=l.n(s),u=l(96026),m=l.n(u),d=l(27361),p=l.n(d),g=l(67294),v=l(86706),f=l(76224),E=l(18377);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e}).apply(this,arguments)}var h=(0,n.h6e)(function({title:e,itemView:t,startItemView:l,itemProps:s={},gridItemProps:u={},gridContainerProps:d={spacing:2},displayLimit:h=4,pagingId:k,canLoadMore:w,buttonMessageLoadmore:b,messagePagination:y,handleUpdateLastRead:_,canLoadSmooth:Z,loadMore:O,numberOfItemsPerPage:x,emptyPage:S="core.block.no_content",emptyPageProps:A,isLoadMoreScroll:N,isLoadMoreButton:C,isLoadMorePagination:I,errorPage:j,hasSort:U=!1,titleBackend:L=!1,moduleName:M,resourceName:V,actionSortName:W}){var $,z,B,D,Q,q,F;let{jsxBackend:G,usePageParams:H,i18n:J}=(0,n.OgA)(),{loggedIn:K,user:R}=(0,n.kPO)(),T=H(),X=(0,n.z88)(null==T?void 0:T.identity),{page:Y}=T,ee=G.get(t),et=G.get(`${t}.skeleton`),el=I?parseInt(Y||1,10):1,[en,er]=(0,n.lWA)(!0),ea=[];if(l){let eo=(null==R?void 0:R.id)&&(null==T?void 0:T.id)&&R.id===parseInt(T.id);ea=(0,a.W$)(l,{pageParams:T,authUser:R,loggedIn:K,isAuthUser:eo,item:X}).map(({as:e,...t},l)=>({component:e,props:{key:l.toString(),...t}}))}let[ei,es]=g.useState(el),ec=(0,v.v9)(e=>(0,n.Drc)(e,k))||(0,n.rjd)(),eu=g.useCallback(()=>{N&&es(e=>e+1)},[N]);(0,n.QP1)(eu);let em=g.useCallback(()=>{O(),es(e=>e+1)},[k]);g.useEffect(()=>{er&&er()},[null==ec?void 0:ec.page,er]),g.useEffect(()=>{!N||(null==ec?void 0:ec.ended)||(null==ec?void 0:ec.loading)||en||em()},[null==ec?void 0:ec.loading,null==ec?void 0:ec.page,N,null==ec?void 0:ec.ended,en,em]);let ed=x||20,ep=I?ed:Math.min(h,4),{loading:eg,refreshing:ev,error:ef,ended:eE,initialized:eP,pagesOffset:eh}=null!=ec?ec:{},ek=w?ec.ids.slice(0,ei*ed):ec.ids.slice(0,h||ec.ids.length);if(I&&(ek=(null===(Q=ec.pages[ei])||void 0===Q?void 0:Q.ids)||[]),g.useEffect(()=>{_&&_()},[ei]),g.useEffect(()=>{if(!I)return;let e=parseInt((null==T?void 0:T.page)||(null==eh?void 0:eh.current_page),10);es(e),O()},[I,null==T?void 0:T.page,null==eh?void 0:eh.current_page]),g.useEffect(()=>{ev&&O()},[eP,ev]),!ea.length&&!ee)return null;if(u.xs||(u.xs=12),ef){if("hide"===j)return null;let ew=p()(ef,"response.data.error")||p()(ef,"response.data.message"),eb=403===p()(ef,"response.status")?"core.block.error403":"core.block.error404",ey=G.get(eb);return g.createElement(ey,{title:ew})}let e_=g.createElement(E.Z,{sx:{display:"block"}},g.createElement(E.Z,{component:"h2",mt:0,mb:.5},null==eh?void 0:eh.title),g.createElement(E.Z,{color:"text.secondary"},null==eh?void 0:eh.description));if(!ek.length&&eE||ef){if("hide"===S)return null;let eZ=G.get(S),{noBlock:eO,contentStyle:ex}=A||{};return eO?g.createElement(eZ,{...A}):g.createElement(r.gO,null,L?g.createElement(r.ti,{children:e_}):g.createElement(r.ti,{title:e}),g.createElement(r.sU,P({},ex),I?g.createElement(f.tl,{currentPage:ei,from:null===(q=ec.pages[ei])||void 0===q?void 0:q.from,to:null===(F=ec.pages[ei])||void 0===F?void 0:F.to,total:(null==eh?void 0:eh.total_item)||(null==eh?void 0:eh.total),itemsPerPage:ed,message:y,hasSort:U,moduleName:M,resourceName:V,actionName:W}):null,g.createElement(eZ,{...A})))}return eP?g.createElement(r.gO,null,L?g.createElement(r.ti,{children:e_}):g.createElement(r.ti,{title:e}),g.createElement(r.sU,null,I?g.createElement(f.tl,{currentPage:ei,from:null===($=ec.pages[ei])||void 0===$?void 0:$.from,to:null===(z=ec.pages[ei])||void 0===z?void 0:z.to,total:(null==eh?void 0:eh.total_item)||(null==eh?void 0:eh.total),itemsPerPage:ed,message:y,hasSort:U,moduleName:M,resourceName:V,actionName:W}):null,g.createElement(o.ZP,P({container:!0},d),c()(ea)&&ea.map((e,t)=>{let l=G.get(e.component);return g.createElement(l,{key:t,itemProps:s,wrapAs:o.ZP,wrapProps:u})}),c()(ek)&&ek.map(e=>g.createElement(ee,{identity:e,itemProps:s,key:e.toString(),wrapAs:o.ZP,wrapProps:u,pagingId:k})),Z&&(N&&!eE||I&&eg||C&&eg)&&et&&eg?m()(0,I&&ek.length?1:ep).map(e=>g.createElement(et,{wrapAs:o.ZP,wrapProps:u,itemProps:s,key:e.toString()})):null),I?g.createElement(f.tl,{currentPage:ei,from:null===(B=ec.pages[ei])||void 0===B?void 0:B.from,to:null===(D=ec.pages[ei])||void 0===D?void 0:D.to,total:(null==eh?void 0:eh.total_item)||(null==eh?void 0:eh.total),itemsPerPage:ed,message:y}):null,!C||eE||eg?null:g.createElement(f.l7,{handleClick:em,message:b}))):et?g.createElement(r.gO,null,L?g.createElement(r.ti,null,g.createElement(i.Z,{height:24,width:160})):g.createElement(r.ti,{title:e}),g.createElement(r.sU,null,g.createElement(o.ZP,P({container:!0},d),m()(0,ep).map(e=>g.createElement(et,{wrapAs:o.ZP,wrapProps:u,itemProps:s,key:e.toString()}))))):g.createElement("div",null,J.formatMessage({id:"loading_dots"}))})}}]);