"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-core-blocks-ListView-ListViewBlock"],{33187:function(e,t,l){l.r(t),l.d(t,{default:function(){return h}});var n=l(85597),r=l(21241),a=l(13478),o=l(30030),i=l(71682),s=l(1469),c=l.n(s),u=l(96026),m=l.n(u),d=l(27361),p=l.n(d),g=l(67294),v=l(86706),f=l(76224),E=l(18377);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e}).apply(this,arguments)}var h=(0,n.h6e)(function({title:e,itemView:t,startItemView:l,itemProps:s={},gridItemProps:u={},gridContainerProps:d={spacing:2},displayLimit:h=4,pagingId:k,canLoadMore:w,buttonMessageLoadmore:b,messagePagination:y,handleUpdateLastRead:_,canLoadSmooth:Z,loadMore:O,numberOfItemsPerPage:x,emptyPage:S="core.block.no_content",emptyPageProps:A,isLoadMoreScroll:N,isLoadMoreButton:C,isLoadMorePagination:I,errorPage:j,hasSort:U=!1,titleBackend:L=!1,moduleName:V,resourceName:W,actionSortName:$}){var z,B,D,M,Q,q,F;let{jsxBackend:G,usePageParams:H,i18n:J,useWidthBreakpoint:K}=(0,n.OgA)(),{loggedIn:R,user:T}=(0,n.kPO)(),X=H(),Y=(0,n.z88)(null==X?void 0:X.identity),{page:ee}=X,et=G.get(t),el=G.get(`${t}.skeleton`),en=I?parseInt(ee||1,10):1,[er,ea]=(0,n.lWA)(!0),eo=K(),ei=12/parseInt(p()(u,eo)||12,10)*2,es=[];if(l){let ec=(null==T?void 0:T.id)&&(null==X?void 0:X.id)&&T.id===parseInt(X.id);es=(0,a.W$)(l,{pageParams:X,authUser:T,loggedIn:R,isAuthUser:ec,item:Y}).map(({as:e,...t},l)=>({component:e,props:{key:l.toString(),...t}}))}let[eu,em]=g.useState(en),ed=(0,v.v9)(e=>(0,n.Drc)(e,k))||(0,n.rjd)(),ep=g.useCallback(()=>{N&&em(e=>e+1)},[N]);(0,n.QP1)(ep);let eg=g.useCallback(()=>{O(),em(e=>e+1)},[k]);g.useEffect(()=>{ea&&ea()},[null==ed?void 0:ed.page,ea]),g.useEffect(()=>{!N||(null==ed?void 0:ed.ended)||(null==ed?void 0:ed.loading)||er||eg()},[null==ed?void 0:ed.loading,null==ed?void 0:ed.page,N,null==ed?void 0:ed.ended,er,eg]);let ev=x||20,ef=I?ev:ei,{loading:eE,refreshing:eP,error:eh,ended:ek,initialized:ew,pagesOffset:eb}=null!=ed?ed:{},ey=w?ed.ids.slice(0,eu*ev):ed.ids.slice(0,h||ed.ids.length);if(I&&(ey=(null===(Q=ed.pages[eu])||void 0===Q?void 0:Q.ids)||[]),g.useEffect(()=>{_&&_()},[eu]),g.useEffect(()=>{if(!I)return;let e=parseInt((null==X?void 0:X.page)||(null==eb?void 0:eb.current_page),10);em(e),O()},[I,null==X?void 0:X.page,null==eb?void 0:eb.current_page]),g.useEffect(()=>{eP&&O()},[ew,eP]),!es.length&&!et)return null;if(u.xs||(u.xs=12),eh){if("hide"===j)return null;let e_=p()(eh,"response.data.error")||p()(eh,"response.data.message"),eZ=403===p()(eh,"response.status")?"core.block.error403":"core.block.error404",eO=G.get(eZ);return g.createElement(eO,{title:e_})}let ex=g.createElement(E.Z,{sx:{display:"block"}},g.createElement(E.Z,{component:"h2",mt:0,mb:.5},null==eb?void 0:eb.title),g.createElement(E.Z,{color:"text.secondary"},null==eb?void 0:eb.description));if(!ey.length&&ek||eh){if("hide"===S)return null;let eS=G.get(S),{noBlock:eA,contentStyle:eN}=A||{};return eA?g.createElement(eS,{...A}):g.createElement(r.gO,null,L?g.createElement(r.ti,{children:ex}):g.createElement(r.ti,{title:e}),g.createElement(r.sU,P({},eN),I?g.createElement(f.tl,{currentPage:eu,from:null===(q=ed.pages[eu])||void 0===q?void 0:q.from,to:null===(F=ed.pages[eu])||void 0===F?void 0:F.to,total:(null==eb?void 0:eb.total_item)||(null==eb?void 0:eb.total),itemsPerPage:ev,message:y,hasSort:U,moduleName:V,resourceName:W,actionName:$}):null,g.createElement(eS,{...A})))}return ew?g.createElement(r.gO,null,L?g.createElement(r.ti,{children:ex}):g.createElement(r.ti,{title:e}),g.createElement(r.sU,null,I?g.createElement(f.tl,{currentPage:eu,from:null===(z=ed.pages[eu])||void 0===z?void 0:z.from,to:null===(B=ed.pages[eu])||void 0===B?void 0:B.to,total:(null==eb?void 0:eb.total_item)||(null==eb?void 0:eb.total),itemsPerPage:ev,message:y,hasSort:U,moduleName:V,resourceName:W,actionName:$}):null,g.createElement(o.ZP,P({container:!0},d),c()(es)&&es.map((e,t)=>{let l=G.get(e.component);return g.createElement(l,{key:t,itemProps:s,wrapAs:o.ZP,wrapProps:u})}),c()(ey)&&ey.map(e=>g.createElement(et,{identity:e,itemProps:s,key:e.toString(),wrapAs:o.ZP,wrapProps:u,pagingId:k})),Z&&(N&&!ek||I&&eE||C&&eE)&&el?m()(0,I&&ey.length?1:ef).map(e=>g.createElement(el,{wrapAs:o.ZP,wrapProps:u,itemProps:s,key:e.toString()})):null),I?g.createElement(f.tl,{currentPage:eu,from:null===(D=ed.pages[eu])||void 0===D?void 0:D.from,to:null===(M=ed.pages[eu])||void 0===M?void 0:M.to,total:(null==eb?void 0:eb.total_item)||(null==eb?void 0:eb.total),itemsPerPage:ev,message:y}):null,!C||ek||eE?null:g.createElement(f.l7,{handleClick:eg,message:b}))):el?g.createElement(r.gO,null,L?g.createElement(r.ti,null,g.createElement(i.Z,{height:24,width:160})):g.createElement(r.ti,{title:e}),g.createElement(r.sU,null,g.createElement(o.ZP,P({container:!0},d),m()(0,ef).map(e=>g.createElement(el,{wrapAs:o.ZP,wrapProps:u,itemProps:s,key:e.toString()}))))):g.createElement("div",null,J.formatMessage({id:"loading_dots"}))})}}]);