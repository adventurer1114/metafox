"use strict";(self.webpackChunk_metafox_react=self.webpackChunk_metafox_react||[]).push([["metafox-photo-components-UploadMultiPhoto-UploadMultiPhotoField"],{42853:function(e,t,r){r.d(t,{Z:function(){return E}});var i,o=r(63366),l=r(87462),n=r(67294),a=r(86010),d=r(94780),s=r(56594),u=r(59711),c=r(81719),m=r(36622),p=r(1588),f=r(34867);function g(e){return(0,f.Z)("MuiFormHelperText",e)}let h=(0,p.Z)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var v=r(78884),b=r(85893);let x=["children","className","component","disabled","error","filled","focused","margin","required","variant"],y=e=>{let{classes:t,contained:r,size:i,disabled:o,error:l,filled:n,focused:a,required:s}=e,u={root:["root",o&&"disabled",l&&"error",i&&`size${(0,m.Z)(i)}`,r&&"contained",a&&"focused",n&&"filled",s&&"required"]};return(0,d.Z)(u,g,t)},Z=(0,c.ZP)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.size&&t[`size${(0,m.Z)(r.size)}`],r.contained&&t.contained,r.filled&&t.filled]}})(({theme:e,ownerState:t})=>(0,l.Z)({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${h.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${h.error}`]:{color:(e.vars||e).palette.error.main}},"small"===t.size&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14})),z=n.forwardRef(function(e,t){let r=(0,v.Z)({props:e,name:"MuiFormHelperText"}),{children:n,className:d,component:c="p"}=r,m=(0,o.Z)(r,x),p=(0,u.Z)(),f=(0,s.Z)({props:r,muiFormControl:p,states:["variant","size","disabled","error","filled","focused","required"]}),g=(0,l.Z)({},r,{component:c,contained:"filled"===f.variant||"outlined"===f.variant,variant:f.variant,size:f.size,disabled:f.disabled,error:f.error,filled:f.filled,focused:f.focused,required:f.required}),h=y(g);return(0,b.jsx)(Z,(0,l.Z)({as:c,ownerState:g,className:(0,a.default)(h.root,d),ref:t},m,{children:" "===n?i||(i=(0,b.jsx)("span",{className:"notranslate",children:"â€‹"})):n}))});var E=z},90798:function(e,t,r){r.d(t,{Z:function(){return a}});var i=r(67294),o=r(13218),l=r.n(o);let n=e=>{return e?l()(e)?n(Object.values(e)[0]):e.toString():null};function a({error:e,className:t="invalid-feedback order-last"}){return e?i.createElement("div",{"data-testid":"error",className:t},n(e)):null}},97252:function(e,t,r){var i=r(27274),o=r(81719),l=r(67294);let n=(0,o.ZP)("div",{name:"MultipleUploadField",slot:"PreviewImg",shouldForwardProp:e=>"radio"!==e})(({theme:e,radio:t})=>({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"auto 100%",maxWidth:"100%",...t&&"horizontal"===t&&{backgroundSize:"cover"}})),a=({item:e})=>{let[t,r]=l.useState({}),o=(e,t)=>{try{let r=new Image;r.src=t,r.onload=()=>{e({height:r.height,width:r.width})},r.onerror=e=>{}}catch(i){}},a=(null==e?void 0:e.source)||e.image_url||(0,i.Q4)(null==e?void 0:e.image,"1024");l.useEffect(()=>{o(r,a)},[]);let d="horizontal";return d=t&&t.width/t.height<=1?"vertical":"horizontal",l.createElement(n,{radio:d,style:{backgroundImage:`url(${a})`}})};t.Z=a},28715:function(e,t,r){r.r(t),r.d(t,{default:function(){return R}});var i=r(90798),o=r(85597),l=r(76224),n=r(21822),a=r(17888),d=r(30030),s=r(38790),u=r(91647),c=r(42853),m=r(81719),p=r(18948),f=r(68929),g=r.n(f),h=r(41609),v=r.n(h),b=r(67294),x=r(97252),y=r(2597),Z=r(27274);let z=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"Control",shouldForwardProp:e=>"haveError"!==e})(({theme:e,haveError:t})=>({height:120,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("secondary"),borderColor:"light"===e.palette.mode?"#0000003b":"rgba(255, 255, 255, 0.23)","& .ico-photos-plus-o":{fontSize:`${e.mixins.pxToRem(15)} !important`},"&:hover":{borderColor:"light"===e.palette.mode?"#000":"#fff"},"& button":{[e.breakpoints.down("sm")]:{flexDirection:"column",height:"auto",maxWidth:"calc(100% - 40px)",padding:"10px"}},...t&&{borderColor:`${e.palette.error.main} !important`}})),E=(0,m.ZP)(n.Z,{name:"DropButton",slot:"DropButton"})(({theme:e,isOver:t})=>({...t&&{backgroundColor:e.palette.action.hover}})),P=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"PreviewItem"})(({theme:e})=>({width:"100%",paddingBottom:"56%",borderRadius:8,background:e.palette.grey.A700,position:"relative",overflow:"hidden"})),k=(0,m.ZP)("video",{name:"MultipleUploadField",slot:"PreviewVideo"})({position:"absolute",left:0,top:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",maxWidth:"100%"}),_=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"removeBtn"})(({theme:e})=>({width:e.spacing(3),height:e.spacing(3),borderRadius:e.spacing(1.5),backgroundColor:"rgba(0,0,0,0.89)",color:"#fff",position:"absolute",top:e.spacing(2),right:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"})),M=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"AddMoreBtnWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",border:e.mixins.border("primary"),borderRadius:e.shape.borderRadius,height:"100%"})),w=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"PreviewVideoWrapper"})(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"})),C=(0,m.ZP)("div",{name:"MultipleUploadField",slot:"MaskPlay"})(({theme:e})=>({position:"absolute",width:e.spacing(5),height:e.spacing(5),color:"#fff",backgroundColor:"rgba(0,0,0,0.4)",borderRadius:"50%",left:"50%",top:"50%",marginLeft:e.spacing(-2.5),marginTop:e.spacing(-2.5),display:"flex",alignItems:"center",justifyContent:"center",fontSize:e.mixins.pxToRem(24)}));function R({name:e,formik:t,acceptTypeFile:r,config:n}){let{accept:m,upload_url:f,item_type:h,max_upload_filesize:R,description:F,label:S}=n,{i18n:j}=(0,o.OgA)(),[,,{setValue:I}]=(0,p.U$)("fileItemType"),[U,T,{setValue:$}]=(0,p.U$)(null!=e?e:"ItemPhotoField"),A=(0,b.useRef)(),[O,B,W]=(0,y.Z)({initialValues:U.value||[],upload_url:f,maxSizeLimit:R}),q=n.placeholder||"add_photo",N=e=>B(t=>t.filter(t=>t.uid!==e)),D=e=>{B(t=>t.map(t=>{return t.id===e?{...t,status:"remove"}:t}))};b.useEffect(()=>{v()(O)&&I(void 0);let e=O.map(e=>({...e,file_type:e.type,fileItemType:h,status:e.status||"update"}));$(e)},[O]);let L=()=>{A.current.click()},H=e=>{e.length&&W(e)},V=()=>{let e=A.current.files;e.length&&(I(h),W(Object.values(e)))},K=Boolean(T.error&&(T.touched||t.submitCount)),Q=O.filter(e=>"remove"!==e.status),X=null==Q?void 0:Q.length;return b.createElement(b.Fragment,null,b.createElement(a.Z,{error:K,fullWidth:!0,margin:"normal"},b.createElement(u.Z,{sx:{fontSize:"13px"},color:"text.hint",mb:1},n.label),X?b.createElement(d.ZP,{container:!0,columnSpacing:1,rowSpacing:1},b.createElement(d.ZP,{item:!0,sm:6,md:3},b.createElement(l.Kb,{style:{height:"100%"},onDrop:e=>H(e),render:({canDrop:e,isOver:t})=>b.createElement(M,null,b.createElement(E,{size:"large",color:"primary",isOver:t,startIcon:b.createElement(l.zb,{icon:"ico-photos-plus-o"}),sx:{fontWeight:"bold"},onClick:L},S))})),null==Q?void 0:Q.map(e=>{var t;return b.createElement(d.ZP,{item:!0,key:e.uid,sm:6,md:3,xs:6},b.createElement(P,null,(0,Z.yh)(null==e?void 0:null===(t=e.file)||void 0===t?void 0:t.type)?b.createElement(w,null,b.createElement(k,{src:null==e?void 0:e.source,controls:!1}),b.createElement(C,null,b.createElement(l.zb,{icon:"ico-play"}))):b.createElement(x.Z,{item:e}),b.createElement(s.Z,{title:j.formatMessage({id:"remove"})},b.createElement(_,{onClick:()=>e.uid?N(e.uid):D(e.id)},b.createElement(l.zb,{icon:"ico-close"})))))})):b.createElement(l.Kb,{onDrop:e=>H(e),render:({canDrop:t,isOver:r})=>b.createElement(z,{haveError:K,role:"button",onClick:L},b.createElement(E,{size:"small",color:"primary",isOver:r,variant:"outlined","data-testid":g()(`field ${e}`),startIcon:b.createElement(l.zb,{icon:"ico-photos-plus-o"})},j.formatMessage({id:q})))}),b.createElement("input",{ref:A,type:"file","aria-hidden":!0,className:"srOnly",multiple:!0,accept:r||m,onChange:V})),F?b.createElement(c.Z,null,F):null,K?b.createElement(i.Z,{error:T.error}):null)}},2597:function(e,t,r){r.d(t,{Z:function(){return u}});var i=r(85597),o=r(67294),l=r(41609),n=r.n(l),a=r(73955),d=r.n(a),s=r(27274);function u({initialValues:e,upload_url:t="",maxSizeLimit:r,isAcceptVideo:l=!0,messageAcceptFail:a}){let{dialogBackend:u,i18n:c}=(0,i.OgA)(),m=o.useRef(!0),[p,f]=o.useState([]),[g,h]=o.useState(e||[]),v=(null==r?void 0:r.photo)||(null==r?void 0:r.other)||0,b=(null==r?void 0:r.video)||(null==r?void 0:r.other)||0,x=e=>{let r=[],i=[];for(let o=0;o<e.length;++o){let n=e[o],m=n.size,p=(0,s.yh)(null==n?void 0:n.type)?b:v,f={id:0,uid:d()(),source:URL.createObjectURL(n),file_name:n.name,file_size:n.size,file_type:n.type,file:n,upload_url:t,type:n.type.match("image/*")?"photo":"video",status:"create"};if("video"===f.type&&!l){u.alert({message:a});break}m>p&&0!==p?(f.max_size=p,i.push(f)):r.push(f)}if(r.length&&h(e=>[...e||[],...r]),i.length>0){var g;u.alert({message:1===i.length?c.formatMessage({id:"warning_upload_limit_one_file"},{fileName:(0,s.TX)(i[0].file_name,30),fileSize:(0,s.jA)(i[0].file_size),maxSize:(0,s.jA)(null===(g=i[0])||void 0===g?void 0:g.max_size)}):c.formatMessage({id:"warning_upload_limit_multi_file"},{numberFile:i.length,photoMaxSize:(0,s.jA)(v),videoMaxSize:(0,s.jA)(b)})})}};return(0,o.useEffect)(()=>{if(m.current=!0,!n()(p))return x(p),()=>{m.current=!1}},[p]),[g,h,f]}}}]);